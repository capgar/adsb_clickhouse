apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-datasources
  namespace: adsb-monitoring
data:
  datasources.yaml: |
    apiVersion: 1
    datasources:
      # Prometheus datasource for operator metrics and real-time monitoring
      - name: Prometheus
        type: prometheus
        access: server
        url: http://prometheus.adsb-monitoring.svc.cluster.local:9090
        jsonData:
          timeInterval: 30s
        editable: true
        isDefault: true

      # Altinity ClickHouse datasource using vertamedia plugin
      - name: ClickHouse
        type: vertamedia-clickhouse-datasource
        uid: clickhouse
        editable: true
        url: http://clickhouse-adsb-data.adsb-clickhouse.svc.cluster.local:8123
        jsonData:
          defaultDatabase: default
        secureJsonData:
          password: <PASSWORD>
        user: adsb_query
      
      # ClickHouse Grafana datasource plugin
      - name: ADS-B ClickHouse
        type: grafana-clickhouse-datasource
        uid: adsb
        editable: true
        jsonData:
          host: clickhouse-adsb-data.adsb-clickhouse.svc.cluster.local
          port: 8123
          protocol: http
          defaultDatabase: adsb
          username: adsb_query
        secureJsonData:
          password: <PASSWORD>